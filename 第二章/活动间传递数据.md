# æ´»åŠ¨é—´ä¼ é€’æ•°æ®


## å‘ä¸‹ä¸€ä¸ªæ´»åŠ¨ä¼ é€’æ•°æ®

å‰é¢æˆ‘ä»¬æ¥è§¦éƒ½æ˜¯å¯åŠ¨ Activity , ç›¸å¯¹äºæ¥è¯´è¿˜æ˜¯ç®€å•çš„. å…¶å®åœ¨æ‰“å¼€çš„è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥å‘æ‰“å¼€çš„åº”ç”¨ä¼ é€’æ•°æ®çš„.

ä¼ é€’æ•°æ®ç›¸å¯¹äºæ¥è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„, Indent æä¾›ä¸€ç³»åˆ— ``putExtra()`` æ–¹æ³•çš„é‡è½½ï¼Œå¯ä»¥æŠŠæˆ‘ä»¬æƒ³è¦ä¼ é€’æ•°æ®æš‚å­˜åœ¨ Intent ä¸­, åœ¨å¯åŠ¨äº†å¦ä¸€ä¸ªæ´»åŠ¨åï¼Œåªéœ€è¦æŠŠè¿™äº›æ•°æ®å†ä»Intentä¸­å–å‡ºå°±å¯ä»¥äº†.

ä»¥å‰é¢çš„å®ä¾‹ï¼Œå‡å¦‚æƒ³ä» FirstActivity ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²åˆ° SecondActivity ,å¯ä»¥è¿™ä¹ˆå†™ï¼š

**FirstActivity.java**
``` java

    final Intent intent = new Intent(FristActivity.this, com.example.activitytest.SecondActivity.class);
    String data = "Hello SecondActivity";
    intent.putExtra("extra_data", data);
    Button button1 = (Button)  findViewById(R.id.button_1);
    button1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            startActivity(intent);
        }
    });

```


**SecondActivity.java**

``` java

public class SecondActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_second);

        // å–å€¼
        Intent intent = getIntent();
        String data = intent.getStringExtra("extra_data");
        Log.d("SecondActivity", data);
    }

}

```

## è¿”å›æ•°æ®ç»™ä¸Šä¸€ä¸ªæ´»åŠ¨

è¿™ç§åœºæ™¯çœŸçš„å¾ˆå¸¸è§,æ¯”å¦‚ åˆ—è¡¨ + è¡¨å• è¡¨å•å¡«å®Œåå¹¶æˆåŠŸåæƒ³æŠŠç»“æœå‘Šè¯‰åˆ—è¡¨é¡µï¼Œæ˜¯å¦æ“ä½œæˆåŠŸï¼Œæ‰å†³å®šæ˜¯å¦åˆ·æ–°é¡µé¢.
è¿”å›ä¸Šä¸€ä¸ªæ´»åŠ¨åªéœ€è¦æŒ‰ ``back`` é”®å°±å¯ä»¥ï¼Œ å¹¶æ²¡æœ‰ä¸€ä¸ªç”¨äºå¯åŠ¨æ´»åŠ¨çš„ Intent æ¥ä¼ é€’æ•°æ®.  é€šè¿‡æŸ¥é˜…æ–‡æ¡£ä½ ä¼šå‘ç°ï¼Œé€šè¿‡ Activity ä¸­çš„ startActivityForResult() æ–¹æ³•ä¹Ÿæ˜¯ç”¨äºå¯åŠ¨æ´»åŠ¨çš„ï¼Œè¿™ä¸ªæ´»åŠ¨æœŸæœ›åœ¨æ´»åŠ¨é”€æ¯çš„æ—¶å€™èƒ½å¤Ÿè¿”å›ä¸€ä¸ªç»“æœç»™ä¸Šä¸€ä¸ªæ´»åŠ¨.

``` java

    Button button1 = (Button)  findViewById(R.id.button_1);
    button1.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {

            /**
                * 1 å¯åŠ¨æ´»åŠ¨æ–¹å¼ startActivityForResult(Intent, Bound)  ç¬¬ä¸€ä¸ªå¯åŠ¨å“ªä¸ªIntentï¼Œ ç¬¬äºŒä¸ªæ˜¯è¯·æ±‚ç ä¸»è¦ç”¨ä¸è¿”å›ç»“æœçš„å›è°ƒä¸­åˆ¤æ–­è¿”å›çš„æ¥æº
                * 2 é‡å†™ onActivityResult æ¥æ”¶è¿”å›å€¼
                */

            final Intent intent = new Intent(FristActivity.this, SecondActivity.class);
            /**
            * Same as calling {@link #startActivityForResult(Intent, int, Bundle)}
            * with no options.
            *
            * @param intent The intent to start.
            * @param requestCode If >= 0, this code will be returned in
            *                    onActivityResult() when the activity exits.
            *
            * @throws android.content.ActivityNotFoundException
            *
            * @see #startActivity
            */
            FristActivity.this.startActivityForResult(intent, 1);
        }
    });

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data){
        super.onActivityResult(requestCode, resultCode, data);
        switch (requestCode) {
            case 1:
                if(resultCode == RESULT_OK){
                    String resultData = data.getStringExtra("data_return");
                    Log.d("FirstActivity", resultData);
                }
                break;
             default:
        }
    }

```

**SecondActivity.java**

``` java

public class SecondActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_second);

//        Intent intent = getIntent();
//        String data = intent.getStringExtra("extra_data");
//        Log.d("SecondActivity", data);

        Button button = (Button) findViewById(R.id.button_2);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                // é€šè¿‡Intentæ¥ä½œä¸ºæ•°æ®çš„è½½ä½“
                Intent intent = new Intent();
                intent.putExtra("data_return", "Hello FirstActivity");
                // ä¸“é—¨ç”¨æ¥è®¾ç½®è¿”å›çš„ç»“æœ
                setResult(RESULT_OK, intent);
                // é”€æ¯å½“å‰ Activity
                finish();
            }
        });
    }

}

```

ğŸ‘†ä¸Šé¢åŸºæœ¬ä¸Šå®Œæˆä½†æ˜¯æœ‰æ²¡æœ‰é—®é¢˜ï¼Ÿ å‡å¦‚ç”¨æˆ·é€šè¿‡ ``è¿”å›é”®``è¿”å›æ—¶ï¼Œè¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ é€šè¿‡é‡å†™ ``onBackPressed()`` æ–¹æ³•

``` java

   @Override
    public void onBackPressed() {
        // é€šè¿‡Intentæ¥ä½œä¸ºæ•°æ®çš„è½½ä½“
        Intent intent = new Intent();
        intent.putExtra("data_return", "Hello FirstActivity");
        // ä¸“é—¨ç”¨æ¥è®¾ç½®è¿”å›çš„ç»“æœ
        setResult(RESULT_OK, intent);
        // é”€æ¯å½“å‰ Activity
        finish();
    }

```
